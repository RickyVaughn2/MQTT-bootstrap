angular.module("Mqtt.Controls",["Mqtt.Services"]),angular.module("Mqtt.Controls").directive("mqttBar",function(){return{restrict:"E",scope:{},controller:["$scope","mqtt",function(a,b){a.connect=function(a,c,d,e,f,g,h){b.connect(a,c,d,e,f),b.subscribe(g,h,a,c,d,e,f)},a.chart=void 0,a.uniqueId="myChart"+a.$id}],link:function(a,b,c,d){var e=c.maxValue;a.connect(c.host,parseInt(c.port),c.user,c.pass,"true"==c.useSsl,c.topic,function(b){var c=parseInt(b.payloadString),d=document.getElementById(a.uniqueId).getContext("2d");void 0==e&&(e=1.2*c),void 0==a.chart?a.chart=new Chart(d).Bar({labels:[b.destinationName],datasets:[{fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[c]}]},{animationSteps:50}):(a.chart.datasets[0].bars[0].value=c,a.chart.update()),a.$apply()})},replace:!0,template:"<canvas id='{{::uniqueId}}' width='400' height='400'></canvas>"}}),angular.module("Mqtt.Controls").directive("mqttDoughnut",function(){return{restrict:"E",scope:{},controller:["$scope","mqtt",function(a,b){a.connect=function(a,c,d,e,f,g,h){b.connect(a,c,d,e,f),b.subscribe(g,h,a,c,d,e,f)},a.chart=void 0,a.uniqueId="myChart"+a.$id}],link:function(a,b,c,d){var e=c.maxValue;a.connect(c.host,parseInt(c.port),c.user,c.pass,"true"==c.useSsl,c.topic,function(b){var c=parseInt(b.payloadString),d=document.getElementById(a.uniqueId).getContext("2d");void 0==e&&(e=1.2*parseInt(c)),void 0==a.chart?a.chart=new Chart(d).Doughnut([{value:c,color:c>80?"#F7464A":"#46BFBD",highlight:c>80?"#FF5A5E":"#5AD3D1",label:b.destinationName},{value:e-c,color:"#FFFFFF",highlight:"#FFFFFF",label:"empty"}],{animationSteps:50}):(a.chart.segments[0].value=c,a.chart.segments[1].value=e-c,a.chart.update()),a.$apply()})},replace:!0,template:"<canvas id='{{::uniqueId}}' width='400' height='400'></canvas>"}}),angular.module("Mqtt.Controls").directive("mqttPublisher",function(){return{restrict:"E",scope:{},controller:["$scope","mqtt",function(a,b){var c,d,e,f,g,h;a.connect=function(a,i,j,k,l,m,n){b.connect(a,i,j,k,l),b.subscribe(m,n,a,i,j,k,l),c=a,d=i,e=j,f=k,g=l,h=m},a.chart=void 0,a.uniqueId="myPub"+a.$id,a.sendMessage=function(){b.sendMessage(document.getElementById(a.uniqueId).value,h,c,d,e,f,g)}}],link:function(a,b,c,d){c.maxValue;a.connect(c.host,parseInt(c.port),c.user,c.pass,"true"==c.useSsl,c.topic,function(b){var c=b.payloadString;document.getElementById(a.uniqueId).value=c,a.$apply()})},replace:!0,template:"<form action='.'>	<input type='text' id='{{::uniqueId}}'></input>	<input type='button' value='Publish' ng-click='sendMessage()' /></form>"}});